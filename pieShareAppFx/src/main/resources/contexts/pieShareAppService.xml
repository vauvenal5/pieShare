<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

   
    <import resource="classpath*:contexts/piePlateApplicationContext.xml" />
    <import resource="classpath*:contexts/pieUtilitiesApplicationContext.xml" />
    <import resource="classpath*:contexts/pieShareAppModel.xml" />
    <import resource="classpath*:contexts/service/pieShareAppAction.xml" />
    
  
    <bean id="pieFile" class="org.pieShare.pieShareApp.service.fileService.PieFile" scope="prototype">
    </bean> 
 
    <bean id="pieDir" class="org.pieShare.pieShareApp.service.fileService.PieDirectory" scope="prototype">
    </bean> 
    
          
    <bean id="pieShareService" class="org.pieShare.pieShareApp.service.PieShareService">
        <property name="executorService" ref="pieExecutorService"/>
        <property name="parserService" ref="pieCommandParser"/>
        <property name="beanService" ref="pieBeanService"/>
        <property name="clusterManagementService" ref="clusterManagementService"/>
    </bean>

  
    <bean id="fileService" class="org.pieShare.pieShareApp.service.fileService.FileService" lazy-init="true">
        <property name="executorService" ref="pieExecutorService"/>
        <property name="clusterManagementService" ref="clusterManagementService"/>
        <property name="fileMerger" ref="fileMerger"/>
        <property name="fileWatcher" ref="fileWatcher"/>
        <property name="beanService" ref="pieBeanService"/>
        <property name="compressor" ref="compressor"/>
        <property name="pieShareAppConfiguration" ref="pieShareAppConfiguration"/>
    </bean>
    
    <bean id="fileMerger" class="org.pieShare.pieShareApp.service.fileService.FileMerger" lazy-init="true">
        <property name="beanService" ref="pieBeanService"/>
        <property name="pieShareAppConfiguration" ref="pieShareAppConfiguration"/>
    </bean>
    
    <bean id="fileRemoteCopyJob" class="org.pieShare.pieShareApp.service.fileService.FileRemoteCopyJob" scope="prototype">
        <property name="compressor" ref="compressor"/>
        <property name="pieShareAppConfiguration" ref="pieShareAppConfiguration"/>
    </bean>
    
    <bean id="fileWatcher" class="org.pieShare.pieShareApp.service.fileService.ApacheFileWatcher" lazy-init="true">    
        <property name="fileListener" ref="fileListener"/>
    </bean>
    
    <bean id="fileListener" class="org.pieShare.pieShareApp.service.fileService.ApacheDefaultFileListener" lazy-init="true">
        <property name="fileObserver" ref="fileObserver"/>   
        <property name="executorService" ref="pieExecutorService"/> 
        <property name="shareService" ref="shareService"/>     
    </bean>
    
    <bean id="simpleMessageCommandService" lazy-init="true" class="org.pieShare.pieShareApp.service.commandService.SimpleMessageCommandService">
    </bean>
    
    <bean id="simpleMessageActionService" class="org.pieShare.pieShareApp.service.actionService.SimpleMessageActionService" lazy-init="true">
        <property name="beanService" ref="pieBeanService"/>
        <property name="commandService" ref="simpleMessageCommandService"/>
    </bean>
    
    <bean id="pieShareAppConfiguration" class="org.pieShare.pieShareApp.service.configurationService.PieShareAppConfiguration" lazy-init="true">
        <property name="configurationReader" ref="configurationReader"/>
    </bean>
    
    <bean id="fileTransferTask" class="org.pieShare.pieShareApp.model.task.FileTransferTask" scope="prototype">
        <property name="fileService" ref="fileService"/>
    </bean>
    
    <bean id="allFilesSyncTask" class="org.pieShare.pieShareApp.model.task.AllFilesSyncTask" scope="prototype">
        <property name="fileService" ref="fileService"/>
    </bean>
    
    <bean id="fileChangedTask" class="org.pieShare.pieShareApp.model.task.FileChangedTask" scope="prototype">
        <property name="fileService" ref="fileService"/>
    </bean>
    
    <bean id="fileTransferRequestTask" class="org.pieShare.pieShareApp.model.task.FileTransferRequestTask" scope="prototype">
        <property name="fileService" ref="fileService"/>
    </bean>
    
    <bean id="loginCommandService" class="org.pieShare.pieShareApp.service.commandService.LoginCommandService">
        <property name="beanService" ref="pieBeanService"/>
        <property name="passwordEncryptionService" ref="passwordEncryptionService"/>
    </bean>

    <bean id="fileObserver" class="org.pieShare.pieShareApp.service.fileService.FileObserver" scope="prototype">
        <property name="shareService" ref="shareService"/>
        <property name="beanService" ref="pieBeanService"/>
    </bean>
    
    <bean id="shareService" class="org.pieShare.pieShareApp.service.shareService.BitTorrentService">
        <property name="clusterManagementService" ref="clusterManagementService"/>
        <property name="configurationService" ref="pieShareAppConfiguration"/>
        <property name="fileUtileService" ref="fileUtileService"/>
        <property name="tmpFolderService" ref="tempFolderService"/>
        <property name="beanService" ref="pieBeanService"/>
    </bean>
    
    <bean id="fileMetaTask" class="org.pieShare.pieShareApp.model.task.FileMetaTask">
        <property name="shareService" ref="shareService"/>
    </bean>
</beans>