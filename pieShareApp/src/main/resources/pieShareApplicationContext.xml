<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx" xmlns:jpa="http://www.springframework.org/schema/data/jpa"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
		http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.1.xsd
		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

   
    <import resource="classpath*:piePlateApplicationContext.xml" />
    <import resource="classpath*:pieUtilitiesApplicationContext.xml" />
     
    <!-- Activate Annotation based configuration -->
    <context:annotation-config />
    
    <!-- Defines where to search for annotated components -->
    <context:component-scan base-package="org.pieShare.pieShareApp" />
    <context:component-scan base-package="org.pieShare.pieShareApp.service.configurationService" />
    
  
    <bean id="pieFile" class="org.pieShare.pieShareApp.service.fileService.PieFile" scope="prototype">
    </bean> 
 
    <bean id="pieDir" class="org.pieShare.pieShareApp.service.fileService.PieDirectory" scope="prototype">
    </bean> 
    
          
    <bean id="pieShareService" class="org.pieShare.pieShareApp.service.PieShareService">
        <property name="executorService" ref="pieExecutorService"/>
        <property name="parserService" ref="pieCommandParser"/>
        <property name="commandLineService" ref="cmdLineService"/>
        <property name="beanService" ref="pieBeanService"/>
        <property name="fileService" ref="fileService"/>
        <property name="clusterManagementService" ref="clusterManagementService"/>
    </bean>

  
    <bean id="fileService" class="org.pieShare.pieShareApp.service.fileService.FileService" lazy-init="true">
        <property name="executorService" ref="pieExecutorService"/>
        <property name="clusterManagementService" ref="clusterManagementService"/>
        <property name="fileMerger" ref="fileMerger"/>
        <property name="fileWatcher" ref="fileWatcher"/>
        <property name="beanService" ref="pieBeanService"/>
    </bean>
    
    <bean id="fileMerger" class="org.pieShare.pieShareApp.service.fileService.FileMerger" lazy-init="true">
        <property name="beanService" ref="pieBeanService"/>
    </bean>
    
    <bean id="fileRemoteCopyJob" class="org.pieShare.pieShareApp.service.fileService.FileRemoteCopyJob" scope="prototype">
    </bean>
    
    <bean id="fileWatcher" class="org.pieShare.pieShareApp.service.fileService.ApacheFileWatcher" lazy-init="true">
        <property name="fileMerger" ref="fileMerger"/>    
        <property name="fileListener" ref="fileListener"/>
    </bean>
    
    <bean id="fileListener" class="org.pieShare.pieShareApp.service.fileService.ApacheDefaultFileListener" lazy-init="true">
        <property name="fileMerger" ref="fileMerger"/>    
    </bean>
    
    <bean id="simpleMessageCommandService" lazy-init="true" class="org.pieShare.pieShareApp.service.commandService.SimpleMessageCommandService">
    </bean>
    
    <bean id="simpleMessageActionService" class="org.pieShare.pieShareApp.service.actionService.SimpleMessageActionService" lazy-init="true">
        <property name="beanService" ref="pieBeanService"/>
        <property name="commandService" ref="simpleMessageCommandService"/>
    </bean>
    
    <bean id="simpleMessageCommand" scope="prototype" lazy-init="true" class="org.pieShare.pieShareApp.model.command.SimpleMessageCommand">  
    </bean>

    <bean id="fileChangedMessage" scope="prototype" lazy-init="true" class="org.pieShare.pieShareApp.model.message.FileChangedMessage">
    </bean>

    <bean id="fileTransfereRequestMessage" class="org.pieShare.pieShareApp.model.message.FileTransferRequestMessage" scope="prototype">
    </bean>

</beans>